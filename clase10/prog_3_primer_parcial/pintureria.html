<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinturería UTN</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="./js/manejadora.js" defer></script>
</head>

<body data-bs-theme="light">
    <!-- Spinner global para peticiones API -->
    <div id="spinnerGlobal" class="position-fixed top-0 start-0 w-100 h-100 d-none" style="z-index: 9999; background: rgba(0,0,0,0.5)">
        <div class="position-absolute top-50 start-50 translate-middle">
            <div class="spinner-border text-light" style="width: 3rem; height: 3rem;"></div>
        </div>
    </div>

    <!-- Navbar fija con logo UTN -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="./img/utnLogo.png" alt="Logo UTN" height="40" class="me-2">
                <span>Pinturería UTN</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto nav" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">Inicio</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="formulario-tab" data-bs-toggle="tab" data-bs-target="#formulario-tab-pane" type="button" role="tab" aria-controls="formulario-tab-pane" aria-selected="false">Formulario</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="listado-tab" data-bs-toggle="tab" data-bs-target="#listado-tab-pane" type="button" role="tab" aria-controls="listado-tab-pane" aria-selected="false">Listado</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="estadisticas-tab" data-bs-toggle="tab" data-bs-target="#estadisticas-tab-pane" type="button" role="tab" aria-controls="estadisticas-tab-pane" aria-selected="false">Estadísticas</button>
                    </li>
                </ul>
                <div class="d-flex">
                    <button id="btnExportarCSV" class="btn btn-outline-light me-2" aria-label="Exportar a CSV">
                        <i class="bi bi-file-earmark-arrow-down"></i> Exportar CSV
                    </button>
                    <button id="btnToggleTheme" class="btn btn-outline-light" aria-label="Cambiar tema">
                        <i class="bi bi-moon-fill"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>
    
    <div class="container mt-4">
        <div class="row mb-3">
            <div class="col-12">
                <h3 class="text-center">Sistema de Gestión de Pinturas</h3>
                <h5 class="text-center text-muted">Plazas, Ricardo Gastón</h5>
            </div>
        </div>
    </div>

    <div class="container-fluid mt-3">
        <!-- Tabs Content -->
        <div class="tab-content" id="myTabContent">
            <!-- Tab de Inicio -->
            <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
                <div class="row justify-content-center">
                    <div class="col-md-10 col-lg-8">
                        <div class="card shadow-sm">
                            <div class="card-body text-center">
                                <h4 class="card-title">Bienvenido al Sistema de Gestión de Pinturas</h4>
                                <p class="card-text mb-4">Esta aplicación permite gestionar el inventario de pinturas interactuando con una API REST.</p>
                                
                                <div class="row text-start">
                                    <div class="col-md-6">
                                        <div class="card mb-3 h-100">
                                            <div class="card-header bg-primary text-white">
                                                <i class="bi bi-gear-fill"></i> Funcionalidades
                                            </div>
                                            <ul class="list-group list-group-flush">
                                                <li class="list-group-item"><i class="bi bi-check-circle text-success"></i> Agregar nuevas pinturas</li>
                                                <li class="list-group-item"><i class="bi bi-check-circle text-success"></i> Modificar pinturas existentes</li>
                                                <li class="list-group-item"><i class="bi bi-check-circle text-success"></i> Eliminar pinturas</li>
                                                <li class="list-group-item"><i class="bi bi-check-circle text-success"></i> Filtrar por marca y precio</li>
                                                <li class="list-group-item"><i class="bi bi-check-circle text-success"></i> Exportar datos a CSV</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card mb-3 h-100">
                                            <div class="card-header bg-primary text-white">
                                                <i class="bi bi-bar-chart-fill"></i> Estadísticas Disponibles
                                            </div>
                                            <ul class="list-group list-group-flush">
                                                <li class="list-group-item"><i class="bi bi-graph-up text-primary"></i> Precio promedio general</li>
                                                <li class="list-group-item"><i class="bi bi-graph-up text-primary"></i> Precio promedio por marca</li>
                                                <li class="list-group-item"><i class="bi bi-graph-up text-primary"></i> Marca más común</li>
                                                <li class="list-group-item"><i class="bi bi-graph-up text-primary"></i> Pintura más cara</li>
                                                <li class="list-group-item"><i class="bi bi-graph-up text-primary"></i> Valor total del inventario</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-4">
                                    <button type="button" class="btn btn-primary" id="btnAgregarPintura">
                                        <i class="bi bi-plus-circle"></i> Agregar Pintura
                                    </button>
                                    <button type="button" class="btn btn-success" id="btnVerListado">
                                        <i class="bi bi-table"></i> Ver Listado
                                    </button>
                                    <button type="button" class="btn btn-info text-white" id="btnVerEstadisticas">
                                        <i class="bi bi-bar-chart"></i> Ver Estadísticas
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab de Formulario -->
            <div class="tab-pane fade" id="formulario-tab-pane" role="tabpanel" aria-labelledby="formulario-tab" tabindex="0">
                <div class="row justify-content-center">
                    <div class="col-md-8 col-lg-6">
                        <div class="card shadow-sm">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0"><i class="bi bi-pencil-square"></i> Formulario de Pinturas</h5>
                            </div>
                            <div class="card-body">
                                <form id="frmFormulario" class="needs-validation" novalidate>
                                    <div class="mb-3">
                                        <label for="inputID" class="form-label">ID:</label>
                                        <input type="text" class="form-control" id="inputID" required readonly aria-label="ID de la pintura">
                                    </div>

                                    <div class="mb-3">
                                        <label for="inputMarca" class="form-label">Marca:</label>
                                        <input type="text" class="form-control" id="inputMarca" required aria-label="Marca de la pintura">
                                        <div class="invalid-feedback">Por favor ingrese la marca de la pintura.</div>
                                    </div>
                        
                                    <div class="mb-3">
                                        <label for="inputPrecio" class="form-label">Precio (USD):</label>
                                        <input type="number" class="form-control" id="inputPrecio" min="50" max="500" step="50" required aria-label="Precio de la pintura">
                                        <div class="invalid-feedback">El precio debe ser entre 50 y 500 USD, en múltiplos de 50.</div>
                                    </div>
                        
                                    <div class="mb-3">
                                        <label for="inputColor" class="form-label">Color:</label>
                                        <input type="color" class="form-control" id="inputColor" value="#ff0000" required aria-label="Color de la pintura">
                                    </div>
                        
                                    <div class="mb-3">
                                        <label for="inputCantidad" class="form-label">Cantidad:</label>
                                        <input type="number" class="form-control" id="inputCantidad" min="1" max="400" required aria-label="Cantidad de pintura">
                                        <div class="invalid-feedback">La cantidad debe ser entre 1 y 400 unidades.</div>
                                    </div>

                                    <div class="d-flex gap-2 mt-4">
                                        <button type="button" id="btnAgregar" class="btn btn-primary">
                                            <i class="bi bi-plus-circle"></i> Agregar
                                        </button>
                                        <button type="reset" class="btn btn-secondary" aria-label="Limpiar formulario">
                                            <i class="bi bi-arrow-counterclockwise"></i> Limpiar
                                        </button>
                                        <button type="button" id="btnModificar" class="btn btn-warning" disabled aria-label="Modificar pintura">
                                            <i class="bi bi-pencil-square"></i> Modificar
                                        </button>
                                        <button type="button" id="btnPromedio" class="btn btn-success" aria-label="Calcular precio promedio">
                                            <i class="bi bi-calculator"></i> Promedio
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab de Listado -->
            <div class="tab-pane fade" id="listado-tab-pane" role="tabpanel" aria-labelledby="listado-tab" tabindex="0">
                <div class="card shadow-sm">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-table"></i> Listado de Pinturas</h5>
                    </div>
                    <div class="card-body" id="divListado">
                        <div class="mb-3 row">
                            <div class="col-md-5">
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                                    <input type="text" class="form-control" id="inputFiltroMarca" placeholder="Filtrar por marca..." aria-label="Filtrar por marca">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <select class="form-select" id="selectFiltroPrecio" aria-label="Filtrar por precio">
                                    <option value="0">Todos los precios</option>
                                    <option value="100">Hasta $100</option>
                                    <option value="200">Hasta $200</option>
                                    <option value="300">Hasta $300</option>
                                    <option value="400">Hasta $400</option>
                                    <option value="500">Hasta $500</option>
                                </select>
                            </div>
                            <div class="col-md-3 d-flex gap-2">
                                <button class="btn btn-primary" id="btnFiltrar" aria-label="Aplicar filtros">
                                    <i class="bi bi-funnel"></i> Filtrar
                                </button>
                                <button class="btn btn-secondary" id="btnLimpiarFiltros" aria-label="Limpiar filtros">
                                    <i class="bi bi-x-circle"></i> Limpiar
                                </button>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-primary">
                                    <tr>
                                        <th scope="col">ID</th>
                                        <th scope="col">Marca</th>
                                        <th scope="col">Precio</th>
                                        <th scope="col">Color</th>
                                        <th scope="col">Cantidad</th>
                                        <th scope="col">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="tblPinturas">
                                    <!-- Las filas se generarán dinámicamente con JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-3 card card-body bg-light">
                            <h6 class="border-bottom pb-2">Resumen</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <p><i class="bi bi-palette"></i> Total de pinturas: <span id="totalPinturas" class="fw-bold">0</span></p>
                                    <p><i class="bi bi-cash"></i> Precio promedio: $<span id="precioPromedio" class="fw-bold">0</span></p>
                                    <p><i class="bi bi-box-seam"></i> Stock total: <span id="stockTotal" class="fw-bold">0</span> unidades</p>
                                </div>
                                <div class="col-md-6">
                                    <p><i class="bi bi-cash-stack"></i> Valor total: $<span id="valorTotal" class="fw-bold">0</span></p>
                                    <p><i class="bi bi-tag"></i> Marca más común: <span id="marcaMasComun" class="fw-bold">Ninguna</span></p>
                                    <p><i class="bi bi-trophy"></i> Pintura más cara: <span id="pinturaMasCara" class="fw-bold">Ninguna</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab de Estadísticas -->
            <div class="tab-pane fade" id="estadisticas-tab-pane" role="tabpanel" aria-labelledby="estadisticas-tab" tabindex="0">
                <div class="card shadow-sm">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="bi bi-bar-chart"></i> Estadísticas</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="mb-0">Resumen General</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                Total de pinturas
                                                <span class="badge bg-primary rounded-pill" id="totalPinturas2">0</span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                Precio promedio
                                                <span class="badge bg-primary rounded-pill">$<span id="precioPromedio2">0</span></span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                Stock total
                                                <span class="badge bg-primary rounded-pill"><span id="stockTotal2">0</span> unidades</span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                Valor total del inventario
                                                <span class="badge bg-primary rounded-pill">$<span id="valorTotal2">0</span></span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                Marca más común
                                                <span class="badge bg-primary rounded-pill" id="marcaMasComun2">Ninguna</span>
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                Pintura más cara
                                                <span class="badge bg-primary rounded-pill" id="pinturaMasCara2">Ninguna</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="mb-0">Distribución por Marca</h6>
                                    </div>
                                    <div class="card-body">
                                        <div id="distribucionMarcas" class="pie-chart-container">
                                            <!-- Se generará dinámicamente -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráfico de barras simple -->
                        <div class="card mt-4">
                            <div class="card-header bg-info text-white">
                                <h6 class="mb-0">Gráfico de Precios por Marca</h6>
                            </div>
                            <div class="card-body">
                                <div id="graficoBarras" class="grafico-container">
                                    <!-- Se generará dinámicamente -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>